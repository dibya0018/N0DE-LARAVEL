import{r as t,t as _,j as e,b as De}from"./app-BAYl1HSz.js";import{D as be,a as ye,b as Se,c as Ce}from"./dialog-DohomiSb.js";import{B as p}from"./button-BUWHkrIo.js";import{T as Ne,a as Ae,b as R,L as Pe}from"./tabs-VLokmgZM.js";import{D as q,a as H,b as X,e as J,f as c}from"./dropdown-menu-zE5wHxoc.js";import{S as Te}from"./search-bar-CXlHkVVx.js";import{A as Me,P as Fe,a as Le,b as y,c as _e,e as ke,d as Oe,f as Ue}from"./pagination-DqjXBUBk.js";import{A as Ee,a as $e,b as Ie,c as ze,d as Ve,e as Be,f as Ge,g as Re}from"./alert-dialog-rwDNo7n6.js";import qe from"./AssetGrid-2_pYCbtF.js";import He from"./AssetTable-CRXC0oAN.js";import Xe from"./AssetUploader-D4dsnDyd.js";import Je from"./AssetDetailsModal-BtHtV5lE.js";import{d as Ke,X as Qe}from"./index-DzNUrV5G.js";import{S as K}from"./Select-b8uBCLur.js";import{C as We}from"./calendar-CA5vAzoc.js";import{P as Ye}from"./plus-WwBbC7Wx.js";import{L as Ze}from"./layout-grid-DOI_FcEe.js";/* empty css            */import"./utils-CSG-oG7g.js";import"./index-D0mva12j.js";import"./index-CDr1GRbl.js";import"./index-CC0gYkaS.js";import"./Combination-DBQolvko.js";import"./index-DRazXELc.js";import"./index-ClMuC-A5.js";import"./index-WjG9McFh.js";import"./index-DU1cekCd.js";import"./floating-ui.dom-DtF1XweH.js";import"./index-WbFOJLSP.js";import"./input-CNhlXZJH.js";import"./chevron-left-CIVxo5Hh.js";import"./chevron-right-D6wPFmnq.js";import"./card-CrMVoWAt.js";import"./checkbox-DM2FAlZO.js";import"./index-47IHtonF.js";import"./check-B69XlBAf.js";import"./badge-QMdTmx3v.js";import"./tooltip-DsY4Q31h.js";import"./AssetActionMenu-Dy7nZ14i.js";import"./ellipsis-vertical-Dhv4-4ce.js";import"./eye-qNAffJdW.js";import"./download-DYCYjKDs.js";import"./trash-CiO9M-2A.js";import"./file-Da2ZVSrE.js";import"./file-image-B6fjxKfq.js";import"./file-text-CWXDWnWc.js";import"./label-cm5VjJbG.js";import"./textarea-BninraIe.js";import"./input-error-BN6HrjaN.js";import"./lock-op3ureYo.js";import"./copy-mrXhSjRK.js";import"./table-BXEyF7RO.js";import"./format-C_TaVLmE.js";import"./scroll-area-4-y7N4RV.js";import"./upload-IcDaw6Sm.js";import"./circle-alert-BCdqIib6.js";import"./image-u2W-qx98.js";import"./extends-CF3RwP-h.js";function rt({isOpen:o,onClose:k,project:u,onSelect:Q,currentlySelected:x=[],allowMultiple:O=!1}){const[r,U]=t.useState({data:[],current_page:1,last_page:1,total:0,per_page:10,from:0,to:0}),[W,E]=t.useState(!0),[i,d]=t.useState([]),[f,m]=t.useState([]),[S,Y]=t.useState(""),[v,Z]=t.useState("all"),[g,ee]=t.useState(""),[C,se]=t.useState("grid"),[w,te]=t.useState("newest"),[N,A]=t.useState(!1),[n,h]=t.useState(1),[P,ae]=t.useState("10"),[$,le]=t.useState(null),[ie,T]=t.useState(!1),[j,re]=t.useState(null),[ne,D]=t.useState(!1);t.useEffect(()=>{o&&(x&&x.length>0?(d(x.map(s=>s.id)),m(x)):(d([]),m([])))},[o,x]),t.useEffect(()=>{o&&M()},[o,S,v,g,w,n,P]),t.useEffect(()=>{const s=r.data.filter(a=>i.includes(a.id)),l=f.filter(a=>!r.data.find(b=>b.id===a.id)&&i.includes(a.id));m([...s,...l])},[r.data,i]);const M=async()=>{E(!0);try{const s=await fetch(route("assets.api.index",u.id)+`?search=${S}&type=${v!=="all"?v:""}&date_filter=${g}&sort=${w}&page=${n}&per_page=${P}`);if(!s.ok)throw new Error("Failed to load assets");const l=await s.json();U(l)}catch{_.error("Failed to load assets")}finally{E(!1)}},I=s=>{if(!O){d([s]);return}d(l=>l.includes(s)?l.filter(a=>a!==s):[...l,s])},oe=s=>{se(s)},ce=s=>{Y(s),h(1)},de=s=>{Z(s),h(1)},me=s=>{ee(s),h(1)},he=s=>{te(s),h(1)},pe=s=>{ae(s),h(1)},ue=()=>{d([]),m([])},xe=()=>{Q(f),k()},z=()=>{k()},fe=()=>{M(),A(!1)},V=s=>{re(s),D(!0)},ge=async s=>{i.includes(s.id)&&(d(i.filter(l=>l!==s.id)),m(f.filter(l=>l.id!==s.id)));try{await De.delete(route("assets.api.destroy",[u.id,s.id])),_.success(`Asset "${s.original_filename}" deleted successfully`),M(),D(!1)}catch(l){console.error("Error deleting asset:",l),_.error("Failed to delete asset"),D(!1)}},F=s=>{h(s)},je=s=>{le(s),T(!0)},ve=s=>{const l={...r,data:r.data.map(a=>a.id===s.id?s:a)};U(l),i.includes(s.id)?m(f.map(a=>a.id===s.id?s:a)):O?(d([...i,s.id]),m([...f,s])):(d([s.id]),m([s])),T(!1)},we=()=>{const s=[];s.push(1);const a=Math.max(2,n-Math.floor(5/2)),b=Math.min(r.last_page-1,a+5-2);a>2&&s.push("ellipsis-start");for(let L=a;L<=b;L++)s.push(L);return b<r.last_page-1&&s.push("ellipsis-end"),r.last_page>1&&s.push(r.last_page),s},B=[{value:"all",label:"All Types"},{value:"image",label:"Images"},{value:"video",label:"Videos"},{value:"audio",label:"Audio"},{value:"document",label:"Documents"},{value:"other",label:"Others"}],G=[{value:"10",label:"10"},{value:"25",label:"25"},{value:"50",label:"50"},{value:"100",label:"100"}];return e.jsxs(e.Fragment,{children:[e.jsx(be,{open:o,onOpenChange:s=>!s&&z(),modal:!0,children:e.jsxs(ye,{className:"sm:max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Se,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Ce,{children:"Asset Library"}),e.jsx(Ke,{className:"sr-only",children:"Select assets to use in your content"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[i.length," ",i.length===1?"asset":"assets"," selected"]}),!N&&e.jsxs(e.Fragment,{children:[i.length>0&&e.jsx(p,{variant:"outline",size:"icon",onClick:ue,"aria-label":"Clear selection",children:e.jsx(Qe,{className:"h-4 w-4"})}),e.jsx(p,{variant:"outline",onClick:z,children:"Cancel"}),e.jsxs(p,{onClick:xe,disabled:i.length===0,children:["Select ",i.length>0?`(${i.length})`:""]})]})]})]})}),N?e.jsx(Xe,{isOpen:!0,onClose:()=>A(!1),projectId:u.id,onUploadComplete:fe}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-2 justify-between",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(Te,{placeholder:"Search assets...",className:"w-full md:w-auto",value:S,onChange:ce}),e.jsx(K,{instanceId:"asset-type-select",options:B,className:"min-w-[140px]",isSearchable:!1,value:B.find(s=>s.value===v),onChange:s=>de((s==null?void 0:s.value)??"all")}),e.jsxs(q,{children:[e.jsx(H,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:"w-[140px]",children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),g?es(g):"Date Filter"]})}),e.jsx(X,{align:"start",children:e.jsxs(J,{value:g,onValueChange:me,children:[e.jsx(c,{value:"",children:"All Time"}),e.jsx(c,{value:"today",children:"Today"}),e.jsx(c,{value:"week",children:"Last 7 days"}),e.jsx(c,{value:"month",children:"Last 30 days"}),e.jsx(c,{value:"quarter",children:"Last 90 days"})]})})]}),e.jsxs(q,{children:[e.jsx(H,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:"w-[140px]",children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),ss(w)]})}),e.jsx(X,{align:"end",children:e.jsxs(J,{value:w,onValueChange:he,children:[e.jsx(c,{value:"newest",children:"Newest"}),e.jsx(c,{value:"oldest",children:"Oldest"}),e.jsx(c,{value:"name",children:"Name"}),e.jsx(c,{value:"size",children:"Size"})]})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(p,{variant:"outline",className:"px-3",onClick:()=>A(!N),children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Upload"]}),e.jsx(Ne,{value:C,onValueChange:oe,className:"hidden md:flex",children:e.jsxs(Ae,{children:[e.jsx(R,{value:"grid",className:"px-3",children:e.jsx(Ze,{className:"h-4 w-4"})}),e.jsx(R,{value:"list",className:"px-3",children:e.jsx(Pe,{className:"h-4 w-4"})})]})})]})]}),W?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs(e.Fragment,{children:[C==="grid"&&e.jsx(qe,{assets:r.data,selectedAssets:i,onAssetSelect:I,project:u,onDelete:V}),C==="list"&&e.jsx(He,{assets:r.data,selectedAssets:i,onAssetSelect:I,onViewDetails:je,onDelete:V}),r.last_page>1&&e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx("div",{className:"pb-1 w-1/2",children:e.jsx(Fe,{className:"justify-start",children:e.jsxs(Le,{children:[e.jsx(y,{children:e.jsx(_e,{href:"#",onClick:s=>{s.preventDefault(),n>1&&F(n-1)},className:n===1?"pointer-events-none opacity-50":""})}),we().map((s,l)=>typeof s=="string"?e.jsx(y,{children:e.jsx(ke,{})},s):e.jsx(y,{children:e.jsx(Oe,{href:"#",onClick:a=>{a.preventDefault(),F(s)},isActive:n===s,children:s})},s)),e.jsx(y,{children:e.jsx(Ue,{href:"#",onClick:s=>{s.preventDefault(),n<r.last_page&&F(n+1)},className:n===r.last_page?"pointer-events-none opacity-50":""})})]})})}),e.jsxs("div",{className:"flex justify-end items-center mb-4 px-2 w-1/2",children:[e.jsx("span",{className:"text-sm text-muted-foreground mr-2",children:"Items per page:"}),e.jsx(K,{instanceId:"items-per-page-select",options:G,className:"w-[70px] h-8",isSearchable:!1,value:G.find(s=>s.value===P),onChange:s=>pe(s.value)})]})]})]})]})]})}),$&&e.jsx(Je,{isOpen:ie,onClose:()=>T(!1),project:u,asset:$,onUpdate:ve}),e.jsx(Ee,{open:ne,onOpenChange:D,children:e.jsxs($e,{children:[e.jsxs(Ie,{children:[e.jsx(ze,{children:"Are you sure you want to delete this asset?"}),e.jsxs(Ve,{children:['This action cannot be undone. This will permanently delete the asset "',j==null?void 0:j.original_filename,'" and remove it from any content that uses it.']})]}),e.jsxs(Be,{children:[e.jsx(Ge,{children:"Cancel"}),e.jsx(Re,{onClick:()=>j&&ge(j),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})}function es(o){switch(o){case"today":return"Today";case"week":return"Last 7 days";case"month":return"Last 30 days";case"quarter":return"Last 90 days";default:return"Date Filter"}}function ss(o){switch(o){case"newest":return"Newest";case"oldest":return"Oldest";case"name":return"Name";case"size":return"Size";default:return"Sort"}}export{rt as MediaLibraryModal};
