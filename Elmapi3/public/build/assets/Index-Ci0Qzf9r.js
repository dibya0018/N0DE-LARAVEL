import{r,u as Se,j as e,H as Ne,a as y,t as _}from"./app-BAYl1HSz.js";import{A as _e}from"./app-layout-BEHjmAYT.js";import Ae from"./AssetGrid-2_pYCbtF.js";import De from"./AssetUploader-D4dsnDyd.js";import Ce from"./AssetTable-CRXC0oAN.js";import{B as w}from"./button-BUWHkrIo.js";import{S as be}from"./separator-DNWIp4wA.js";import{C as Te}from"./checkbox-DM2FAlZO.js";import{S as O,a as E,F as ke,b as U,c as B,d as p}from"./select-CN0qBbIi.js";import{T as Fe,a as Le,b as I,L as Me,c as G}from"./tabs-VLokmgZM.js";import{A as R,a as Z,b as q,c as H,d as $,e as X,f as J,g as K}from"./alert-dialog-rwDNo7n6.js";import{D as Q,a as W,b as Y,c as ee,d as se,e as te,f as n}from"./dropdown-menu-zE5wHxoc.js";import{A as Pe,P as Ve,a as ze,b as u,c as Oe,d as S,e as ae,f as Ee}from"./pagination-DqjXBUBk.js";import{S as Ue}from"./search-bar-CXlHkVVx.js";import{T as Be,a as Ie,b as Ge,c as Re}from"./tooltip-DsY4Q31h.js";import Ze from"./ProjectSidebar-QmuUIZrJ.js";import qe from"./AssetDetailsModal-BtHtV5lE.js";import{P as He}from"./plus-WwBbC7Wx.js";import{C as $e}from"./calendar-CA5vAzoc.js";import{L as Xe}from"./layout-grid-DOI_FcEe.js";import{X as Je}from"./index-DzNUrV5G.js";import{T as Ke}from"./trash-CiO9M-2A.js";/* empty css            */import"./utils-CSG-oG7g.js";import"./index-D0mva12j.js";import"./Combination-DBQolvko.js";import"./index-DRazXELc.js";import"./user-BSjMmka3.js";import"./settings-Bhr0gP4l.js";import"./app-logo-icon-BrzWybGo.js";import"./index-B_2jjvkB.js";import"./folder-BjjgW9yE.js";import"./image-u2W-qx98.js";import"./globe-CUGWl2f4.js";import"./users-DJytDsFA.js";import"./key-BAlHmL0b.js";import"./download-DYCYjKDs.js";import"./chevron-right-D6wPFmnq.js";import"./card-CrMVoWAt.js";import"./badge-QMdTmx3v.js";import"./AssetActionMenu-Dy7nZ14i.js";import"./ellipsis-vertical-Dhv4-4ce.js";import"./eye-qNAffJdW.js";import"./file-Da2ZVSrE.js";import"./file-image-B6fjxKfq.js";import"./file-text-CWXDWnWc.js";import"./dialog-DohomiSb.js";import"./scroll-area-4-y7N4RV.js";import"./index-WjG9McFh.js";import"./index-ClMuC-A5.js";import"./upload-IcDaw6Sm.js";import"./circle-alert-BCdqIib6.js";import"./table-BXEyF7RO.js";import"./format-C_TaVLmE.js";import"./index-47IHtonF.js";import"./index-WbFOJLSP.js";import"./check-B69XlBAf.js";import"./index-CC0gYkaS.js";import"./index-DU1cekCd.js";import"./floating-ui.dom-DtF1XweH.js";import"./chevron-down-Cw2QYx2J.js";import"./index-CDr1GRbl.js";import"./chevron-left-CIVxo5Hh.js";import"./input-CNhlXZJH.js";import"./dnd.esm-Bv3pd172.js";import"./extends-CF3RwP-h.js";import"./CreateCollectionModal-CWXrQL5D.js";import"./label-cm5VjJbG.js";import"./input-error-BN6HrjaN.js";import"./Select-b8uBCLur.js";import"./radio-group-CThl2yM6.js";import"./DeleteCollectionModal-GNqxQqVK.js";import"./grip-vertical-CVrUASli.js";import"./textarea-BninraIe.js";import"./lock-op3ureYo.js";import"./copy-mrXhSjRK.js";const Qe="newest";function wt({project:l,assets:m,filters:i}){const[re,b]=r.useState(!1),[a,h]=r.useState([]),[x,A]=r.useState(""),[o,T]=r.useState("all"),[c,k]=r.useState(""),[le,D]=r.useState(!1),[g,N]=r.useState(null),[ie,F]=r.useState("grid"),[d,L]=r.useState(Qe),[M,ne]=r.useState(null),[oe,P]=r.useState(!1),[t,ce]=r.useState(m),C=Se().props.userCan;r.useEffect(()=>{i&&(typeof i.search=="string"&&A(i.search),typeof i.type=="string"&&T(i.type),typeof i.date_filter=="string"&&k(i.date_filter),typeof i.sort=="string"&&L(i.sort));try{const s=localStorage.getItem("assetViewMode");(s==="grid"||s==="list")&&F(s)}catch(s){console.error("Error loading view mode from localStorage:",s)}ce(m)},[i,m]);const de=s=>{F(s),localStorage.setItem("assetViewMode",s)},j=s=>{s.search!==void 0&&A(s.search),s.type!==void 0&&T(s.type),s.dateFilter!==void 0&&k(s.dateFilter),s.sort!==void 0&&L(s.sort);const v={search:s.search??x,type:(s.type??o)==="all"?"":s.type??o,date_filter:s.dateFilter??c,sort:s.sort??d,per_page:s.perPage??i.per_page};h([]),y.get(route("assets.index",l.id),v,{preserveState:!0,replace:!0})},me=s=>{A(s);const v=setTimeout(()=>{j({search:s})},500);return()=>clearTimeout(v)},he=s=>{j({type:s})},pe=s=>{j({dateFilter:s})},ue=s=>{j({sort:s})},f=s=>{h([]),y.get(route("assets.index",l.id),{page:s,search:x,type:o==="all"?"":o},{preserveState:!0})},V=s=>{s&&(a.includes(s)?h(a.filter(v=>v!==s)):h([...a,s]))},xe=()=>{m!=null&&m.data&&(a.length===m.data.length?h([]):h(m.data.map(s=>s.id)))},ge=()=>{a.length!==0&&y.post(route("assets.bulk-destroy",l.id),{asset_ids:a},{onSuccess:()=>{h([]),D(!1);const s=a.length;_.success(`${s} ${s===1?"asset":"assets"} deleted successfully`),j({search:x,type:o,dateFilter:c})},onError:()=>{_.error("Failed to delete assets")},preserveState:!0,replace:!0})},z=s=>{N(s)},je=()=>{g&&y.delete(route("assets.destroy",[l.id,g.id]),{onSuccess:()=>{_.success(`Asset "${g.original_filename}" deleted successfully`),N(null),j({search:x,type:o,dateFilter:c})},onError:()=>{_.error("Failed to delete asset"),N(null)},preserveState:!0,replace:!0})},fe=[{title:l.name,href:route("projects.show",l.id)},{title:"Asset Library",href:route("assets.index",l.id)}],ve=()=>c==="today"?"Today":c==="week"?"Last 7 days":c==="month"?"Last 30 days":c==="quarter"?"Last 90 days":"Date Filter",ye=s=>{ne(s),P(!0)},we=()=>{h([])};return e.jsxs(_e,{breadcrumbs:fe,children:[e.jsx(Ne,{title:"Asset Library"}),e.jsxs("div",{className:"flex space-x-6",children:[e.jsx(Ze,{project:l}),e.jsx(be,{className:"my-6 md:hidden"}),e.jsx("div",{className:"flex-1 w-full",children:e.jsx("section",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsxs(Fe,{defaultValue:"grid",value:ie,onValueChange:de,children:[e.jsxs("div",{className:"flex justify-between items-center space-x-4 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Asset Library"}),C.upload_asset&&e.jsxs(w,{onClick:()=>b(!0),children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Upload Asset"]})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[C.delete_asset&&e.jsx("div",{className:"flex items-center space-x-2 border p-2 rounded-md",children:e.jsx(Te,{checked:a.length>0&&a.length===m.data.length,onCheckedChange:xe,id:"select-all",className:"h-5 w-5"})}),e.jsx("div",{className:"relative flex-1",children:e.jsx(Ue,{value:x,onChange:me,placeholder:"Search assets...",className:"w-full"})}),e.jsxs(O,{value:o,onValueChange:he,children:[e.jsx(E,{className:"w-[180px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-4 w-4"}),e.jsx(U,{placeholder:"Filter by type"})]})}),e.jsxs(B,{children:[e.jsx(p,{value:"all",children:"All types"}),e.jsx(p,{value:"image",children:"Images"}),e.jsx(p,{value:"video",children:"Videos"}),e.jsx(p,{value:"audio",children:"Audio"}),e.jsx(p,{value:"document",children:"Documents"})]})]}),e.jsxs(Q,{children:[e.jsx(W,{asChild:!0,children:e.jsxs(w,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),ve()]})}),e.jsxs(Y,{className:"w-40",children:[e.jsx(ee,{children:"Filter by date"}),e.jsx(se,{}),e.jsxs(te,{value:c,onValueChange:pe,children:[e.jsx(n,{value:"",children:"All time"}),e.jsx(n,{value:"today",children:"Today"}),e.jsx(n,{value:"week",children:"Last 7 days"}),e.jsx(n,{value:"month",children:"Last 30 days"}),e.jsx(n,{value:"quarter",children:"Last 90 days"})]})]})]}),e.jsxs(Q,{children:[e.jsx(W,{asChild:!0,children:e.jsxs(w,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"h-4 w-4"}),d==="newest"&&"Newest first",d==="oldest"&&"Oldest first",d==="name_asc"&&"Name A-Z",d==="name_desc"&&"Name Z-A",d==="size_asc"&&"Size (smallest)",d==="size_desc"&&"Size (largest)",!d&&"Sort by"]})}),e.jsxs(Y,{className:"w-40",children:[e.jsx(ee,{children:"Sort by"}),e.jsx(se,{}),e.jsxs(te,{value:d,onValueChange:ue,children:[e.jsx(n,{value:"newest",children:"Newest first"}),e.jsx(n,{value:"oldest",children:"Oldest first"}),e.jsx(n,{value:"name_asc",children:"Name A-Z"}),e.jsx(n,{value:"name_desc",children:"Name Z-A"}),e.jsx(n,{value:"size_asc",children:"Size (smallest)"}),e.jsx(n,{value:"size_desc",children:"Size (largest)"})]})]})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(Le,{children:[e.jsx(I,{value:"grid","aria-label":"Grid View",children:e.jsx(Xe,{className:"h-4 w-4"})}),e.jsx(I,{value:"list","aria-label":"List View",children:e.jsx(Me,{className:"h-4 w-4"})})]})}),a.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm",children:[a.length," selected"]}),a.length>0&&e.jsx(Be,{children:e.jsxs(Ie,{children:[e.jsx(Ge,{asChild:!0,children:e.jsx(w,{variant:"outline",size:"icon",onClick:we,children:e.jsx(Je,{className:"h-4 w-4"})})}),e.jsx(Re,{children:"Clear selection"})]})}),C.delete_asset&&e.jsxs(w,{variant:"destructive",size:"sm",onClick:()=>D(!0),children:[e.jsx(Ke,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]}),e.jsx(G,{value:"grid",children:t.data.length>0?e.jsx(Ae,{assets:t.data,selectedAssets:a,onAssetSelect:V,project:l,onDelete:z}):e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"No assets found"})}),e.jsx(G,{value:"list",children:t.data.length>0?e.jsx(Ce,{assets:t.data,selectedAssets:a,onAssetSelect:V,onViewDetails:ye,onDelete:z}):e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"No assets found"})})]}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx("div",{className:"pb-1 w-1/2",children:t&&t.last_page>1&&e.jsx(Ve,{className:"justify-start",children:e.jsxs(ze,{children:[e.jsx(u,{children:e.jsx(Oe,{href:"#",onClick:s=>{s.preventDefault(),f(t.current_page-1)},"aria-disabled":t.current_page===1,className:t.current_page===1?"pointer-events-none opacity-50":""})}),e.jsx(u,{children:e.jsx(S,{href:"#",onClick:s=>{s.preventDefault(),f(1)},isActive:t.current_page===1,children:"1"})}),t.current_page>3&&e.jsx(u,{children:e.jsx(ae,{})}),t.current_page>2&&e.jsx(u,{children:e.jsx(S,{href:"#",onClick:s=>{s.preventDefault(),f(t.current_page-1)},children:t.current_page-1})}),t.current_page!==1&&t.current_page!==t.last_page&&e.jsx(u,{children:e.jsx(S,{href:"#",onClick:s=>{s.preventDefault(),f(t.current_page)},isActive:!0,children:t.current_page})}),t.current_page<t.last_page-1&&e.jsx(u,{children:e.jsx(S,{href:"#",onClick:s=>{s.preventDefault(),f(t.current_page+1)},children:t.current_page+1})}),t.current_page<t.last_page-2&&e.jsx(u,{children:e.jsx(ae,{})}),t.last_page>1&&e.jsx(u,{children:e.jsx(S,{href:"#",onClick:s=>{s.preventDefault(),f(t.last_page)},isActive:t.current_page===t.last_page,children:t.last_page})}),e.jsx(u,{children:e.jsx(Ee,{href:"#",onClick:s=>{s.preventDefault(),f(t.current_page+1)},"aria-disabled":t.current_page===t.last_page,className:t.current_page===t.last_page?"pointer-events-none opacity-50":""})})]})})}),t.total>0&&e.jsxs("div",{className:"flex justify-end items-center mb-4 px-2 w-1/2",children:[e.jsxs("div",{className:"text-sm text-muted-foreground mr-4",children:["Showing ",e.jsx("span",{className:"font-semibold",children:t.from})," to"," ",e.jsx("span",{className:"font-semibold",children:t.to})," of"," ",e.jsx("span",{className:"font-semibold",children:t.total})," assets"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground mr-2",children:"Per page:"}),e.jsxs(O,{value:(i.per_page||"10").toString(),onValueChange:s=>{h([]),y.get(route("assets.index",l.id),{search:x,type:o==="all"?"":o,date_filter:c,sort:d,per_page:s},{preserveState:!0,replace:!0})},children:[e.jsx(E,{className:"w-[80px] h-8",children:e.jsx(U,{})}),e.jsxs(B,{children:[e.jsx(p,{value:"10",children:"10"}),e.jsx(p,{value:"25",children:"25"}),e.jsx(p,{value:"50",children:"50"}),e.jsx(p,{value:"100",children:"100"})]})]})]})]})]})]})})})]}),e.jsx(De,{isOpen:re,onClose:()=>b(!1),projectId:l.id,onUploadComplete:()=>{j({search:x,type:o,dateFilter:c})}}),e.jsx(R,{open:le,onOpenChange:D,children:e.jsxs(Z,{children:[e.jsxs(q,{children:[e.jsx(H,{children:"Delete Selected Assets"}),e.jsxs($,{children:["Are you sure you want to delete ",a.length," ",a.length===1?"asset":"assets","? This action cannot be undone and the files will be permanently removed."]})]}),e.jsxs(X,{children:[e.jsx(J,{children:"Cancel"}),e.jsx(K,{onClick:ge,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90 text-white",children:"Delete"})]})]})}),e.jsx(R,{open:!!g,onOpenChange:s=>!s&&N(null),children:e.jsxs(Z,{children:[e.jsxs(q,{children:[e.jsx(H,{children:"Delete Asset"}),e.jsxs($,{children:['Are you sure you want to delete "',g==null?void 0:g.original_filename,'"? This action cannot be undone and the file will be permanently removed.']})]}),e.jsxs(X,{children:[e.jsx(J,{children:"Cancel"}),e.jsx(K,{onClick:je,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90 text-white",children:"Delete"})]})]})}),M&&e.jsx(qe,{isOpen:oe,onClose:()=>P(!1),project:l,asset:M})]})}export{wt as default};
