import{r as n,u as v,j as e,L as N,b as O}from"./app-BAYl1HSz.js";import{B as _}from"./button-BUWHkrIo.js";import{S as k}from"./search-bar-CXlHkVVx.js";import{D as L,C as A,P as B}from"./dnd.esm-Bv3pd172.js";import{D as R,a as G,b as Q,g as b}from"./dropdown-menu-zE5wHxoc.js";import w from"./CreateCollectionModal-CWXrQL5D.js";import V from"./DeleteCollectionModal-GNqxQqVK.js";import{P as z}from"./plus-WwBbC7Wx.js";import{G as F}from"./grip-vertical-CVrUASli.js";import{S as H}from"./settings-Bhr0gP4l.js";import{E as T}from"./ellipsis-vertical-Dhv4-4ce.js";/* empty css            */import"./utils-CSG-oG7g.js";import"./input-CNhlXZJH.js";import"./extends-CF3RwP-h.js";import"./index-D0mva12j.js";import"./index-DRazXELc.js";import"./index-CC0gYkaS.js";import"./index-ClMuC-A5.js";import"./Combination-DBQolvko.js";import"./index-DU1cekCd.js";import"./floating-ui.dom-DtF1XweH.js";import"./index-WbFOJLSP.js";import"./index-WjG9McFh.js";import"./index-CDr1GRbl.js";import"./dialog-DohomiSb.js";import"./index-DzNUrV5G.js";import"./label-cm5VjJbG.js";import"./input-error-BN6HrjaN.js";import"./Select-b8uBCLur.js";import"./checkbox-DM2FAlZO.js";import"./index-47IHtonF.js";import"./check-B69XlBAf.js";import"./radio-group-CThl2yM6.js";import"./upload-IcDaw6Sm.js";function Me({project:s}){const[D,u]=n.useState(!1),[S,x]=n.useState(!1),[E,h]=n.useState(!1),[f,g]=n.useState(null),[a,M]=n.useState(""),[C,c]=n.useState(s.collections??[]),l=v(),i=l.props.userCan,{collection:d}=l.props;n.useEffect(()=>{c(s.collections??[])},[s.collections]);const m=l.component==="Collections/Edit",y=t=>l.component==="Collections/Show"||l.component==="Collections/Edit"?(d==null?void 0:d.id)===t:!1,j=C.filter(t=>t.name.toLowerCase().includes(a.toLowerCase())||t.slug.toLowerCase().includes(a.toLowerCase())),I=async t=>{if(!t.destination)return;const o=Array.from(C),[p]=o.splice(t.source.index,1);o.splice(t.destination.index,0,p),c(o);try{await O.post(route("projects.collections.reorder",s.id),{collections:o.map((r,P)=>({id:r.id,order:P}))})}catch(r){console.error("Failed to update collection order:",r),c(s.collections??[])}};return e.jsxs("div",{children:[e.jsxs("aside",{className:"w-full lg:w-64 space-y-4 sticky top-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium",children:"Collections"}),i.create_collection&&e.jsxs(_,{variant:"default",size:"sm",className:"h-6 px-1 text-xs",onClick:()=>u(!0),children:[e.jsx(z,{className:"mr-1"}),"Add New"]})]}),e.jsx(k,{value:a,onChange:M,placeholder:"Search collections...",className:"px-1"}),e.jsx(L,{onDragEnd:I,children:e.jsx(A,{droppableId:"collections",children:t=>e.jsxs("div",{...t.droppableProps,ref:t.innerRef,className:"space-y-1",children:[j.map((o,p)=>e.jsx(B,{draggableId:o.id.toString(),index:p,isDragDisabled:!m,children:r=>e.jsxs("div",{ref:r.innerRef,...r.draggableProps,className:"flex items-center space-x-2",children:[m&&e.jsx("div",{...r.dragHandleProps,className:"p-2 text-muted-foreground hover:text-foreground cursor-grab",children:e.jsx(F,{className:"w-4 h-4"})}),e.jsx(N,{href:route("projects.collections.show",[s.id,o.id]),className:`flex-1 p-2 text-sm rounded-md hover:bg-accent ${y(o.id)?"bg-accent text-accent-foreground":""}`,children:o.name}),i.access_collection_settings&&e.jsx(N,{href:route("projects.collections.edit",[s.id,o.id]),className:"block p-2 text-sm rounded-md hover:bg-accent",children:e.jsx(H,{className:"w-4 h-4"})}),m&&(i.update_collection||i.delete_collection)&&e.jsxs(R,{children:[e.jsx(G,{asChild:!0,children:e.jsx("button",{className:"block p-2 text-sm rounded-md hover:bg-accent",children:e.jsx(T,{className:"w-4 h-4"})})}),e.jsxs(Q,{align:"end",children:[i.update_collection&&e.jsx(b,{className:"cursor-pointer",onClick:()=>{g(o),x(!0)},children:"Edit Collection"}),i.delete_collection&&e.jsx(b,{className:"text-destructive cursor-pointer",onClick:()=>{g(o),h(!0)},children:"Delete Collection"})]})]})]})},o.id)),t.placeholder,j.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground px-2",children:a?"No collections found":"No collections yet"})]})})})]}),e.jsx(w,{open:D,onOpenChange:u,projectId:s.id}),e.jsx(w,{open:S,onOpenChange:x,projectId:s.id,collection:f}),e.jsx(V,{open:E,onOpenChange:h,projectId:s.id,collection:f})]})}export{Me as default};
