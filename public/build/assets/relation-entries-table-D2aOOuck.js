import{U as j,j as e}from"./app-BAYl1HSz.js";import{h as y}from"./moment-BLMuvzoS.js";import{B as D}from"./badge-QMdTmx3v.js";import{D as $,C as E,P as S}from"./dnd.esm-Bv3pd172.js";import{g as P}from"./lexical-converter-4eQd3LVe.js";import{F as R}from"./file-text-CWXDWnWc.js";function _({fields:x,entries:m,showStatus:p=!0,showCreated:h=!0,onOrderChange:f}){const[g,b]=j.useState(m);j.useEffect(()=>{b(m)},[m]);const N=t=>{if(!t.destination)return;const r=Array.from(g),[a]=r.splice(t.source.index,1);r.splice(t.destination.index,0,a),b(r),f&&f(r)},i=!p||!h,w=t=>{i&&N(t)},A=(t,r)=>{var a,c,o,u;if(r==null||r==="")return"-";if((a=t.options)!=null&&a.repeatable&&Array.isArray(r)){if(r.length===0)return"-";const n=r[0];if(typeof n=="object"&&n!==null&&!Array.isArray(n))return`${r.length} item${r.length===1?"":"s"}`;if(typeof n!="object")return`${n}${r.length>1?` (+${r.length-1} more)`:""}`}switch(t.type){case"text":case"longtext":return typeof r=="string"&&r.length>30?`${r.substring(0,30)}...`:r;case"email":case"slug":return r;case"richtext":{const s=P(r);return s.length>30?`${s.substring(0,30)}...`:s}case"date":{const s="YYYY-MM-DD"+((c=t.options)!=null&&c.includeTime?" HH:mm":"");return((o=t.options)==null?void 0:o.mode)==="range"&&typeof r=="string"?r.split(" - ").map(d=>y.parseZone(d).format(s)).join(" / "):y.parseZone(r).format(s)}case"boolean":return r?"Yes":"No";case"enumeration":if(Array.isArray(r))return r.join(", ");if(typeof r=="string")try{const s=JSON.parse(r);if(Array.isArray(s))return s.join(", ")}catch{}return r;case"number":return r===null?"-":Number(r).toString();case"media":return r&&Array.isArray(r)?e.jsx("div",{className:"flex flex-wrap gap-1",children:r.map((s,d)=>e.jsx("div",{className:"w-8 h-8",children:s.thumbnail_url?e.jsx("img",{src:s.thumbnail_url,alt:"",className:"w-full h-full object-cover rounded"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-muted rounded",children:e.jsx(R,{className:"w-4 h-4"})})},d))}):"-";case"relation":return Array.isArray(r)?`${r.length} relation${r.length===1?"":"s"}`:r?"1 relation":"-";case"group":const n=Array.isArray(r)?r:r?[r]:[];if(n.length>0){if((u=t.options)!=null&&u.repeatable)return`${n.length} item${n.length===1?"":"s"}`;{const s=t.children||[];if(s.length>0&&n[0]){const d=s[0],l=n[0][d.name];if(l!=null&&l!=="")return String(l).length>30?`${String(l).substring(0,30)}...`:String(l)}return"Group data"}}return"-";default:return typeof r=="object"&&r!==null&&!Array.isArray(r)?JSON.stringify(r):r}};return e.jsx("div",{className:"overflow-x-auto w-full",children:e.jsx($,{onDragEnd:w,children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[p&&e.jsx("th",{className:"px-4 py-2 text-left whitespace-nowrap",children:"Status"}),h&&e.jsx("th",{className:"px-4 py-2 text-left whitespace-nowrap",children:"Created"}),i&&e.jsx("th",{className:"w-4"}),x.map(t=>e.jsx("th",{className:"px-4 py-2 text-left whitespace-nowrap",children:t.label},t.id))]})}),e.jsx(E,{droppableId:"relation-entries-table",direction:"vertical",isDropDisabled:!i,children:t=>e.jsxs("tbody",{ref:t.innerRef,...t.droppableProps,children:[g.map((r,a)=>e.jsx(S,{draggableId:String(r.id),index:a,isDragDisabled:!i,children:c=>e.jsxs("tr",{ref:c.innerRef,...i?c.draggableProps:{},className:"border-t hover:bg-muted/20",children:[p&&e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:e.jsx(D,{variant:r.status==="published"?"default":r.status==="trashed"?"destructive":"outline",className:r.status==="published"?"bg-green-600 hover:bg-green-700":r.status==="trashed"?"bg-red-600 hover:bg-red-700":"text-amber-600 border-amber-300",children:r.status==="published"?"Published":r.status==="trashed"?"Trashed":"Draft"})}),h&&e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:new Date(r.created_at).toLocaleString()}),i&&e.jsx("td",{className:"px-2 cursor-grab",...c.dragHandleProps,children:e.jsxs("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:[e.jsx("circle",{cx:"3",cy:"5",r:"1.5"}),e.jsx("circle",{cx:"3",cy:"10.5",r:"1.5"}),e.jsx("circle",{cx:"8",cy:"5",r:"1.5"}),e.jsx("circle",{cx:"8",cy:"10.5",r:"1.5"}),e.jsx("circle",{cx:"13",cy:"5",r:"1.5"}),e.jsx("circle",{cx:"13",cy:"10.5",r:"1.5"})]})}),x.map(o=>e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:A(o,r[o.name])},o.id))]})},r.id)),t.placeholder,g.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"px-4 py-6 text-muted-foreground text-center",colSpan:x.length+(p?1:0)+(h?1:0)+(i?1:0),children:"No related entries"})})]})})]})})})}export{_ as R};
